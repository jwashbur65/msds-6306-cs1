---
title: "Analysis"
author: "Lavonnia Newman, Joseph Caguioa, Jeff Washburn"
date: "1/7/2019"
output: 
  html_document:
    theme: default
    highlight: tango
    toc: true
    toc_depth: 3
    toc_float:
      collapsed: false

---

```{r setup, include=F, message=F}
knitr::opts_chunk$set(echo = TRUE)

# Install packages if not already installed. Adapted from https://stackoverflow.com/questions/4090169/elegant-way-to-check-for-missing-packages-and-install-them.
list_of_packages <- c("dplyr", "ggplot2", "kableExtra", "knitr", "plyr", "psych", "usmap")
new_packages <- list_of_packages[!(list_of_packages %in% installed.packages()[,"Package"])]
if(length(new_packages)) install.packages(new_packages)

# Load multiple packages at once.
lapply(list_of_packages, library, character.only=TRUE)

```

```{r more_setup, echo=F}
# jquery/DataTable infrastructure for dynamic kable output follows.
# Consider integrating into custom_html.css if time allows.
# Test to see whether this is desired for all instances of kable. Note that activating these deactivates the HTML table of contents for some reason.
```
<link rel="stylesheet" type="text/css" href="http://cdn.datatables.net/1.10.5/css/jquery.dataTables.min.css">
<script src="http://code.jquery.com/jquery-2.1.2.min.js"></script>
<script src="http://cdn.datatables.net/1.10.5/js/jquery.dataTables.min.js"></script>

<script type="text/javascript">
         $(document).ready(function() {
             $("table").DataTable();
         } );
</script>

# Introduction

```{r logo1, out.width="150px", fig.align="center", echo=F}
knitr::include_graphics("Images/CheunChugs&Cheers.png")
```

Cheun Chugs & Cheers (henceforth referred to by its ticker symbol CCAC, or simply "the client") is an American hospitality company. Founded in 2008 in Reno, NV, by eponymous owner Jacquelyn Cheun, CCAC owns and operates a number of popular bars along the East Coast, including:

* Reproducible Refreshment with OurStudio
* Statistics Never Lie
* Below the Tableau
* Spam and Eggs
* Munging by Moonlight

CCAC prefers sourcing the majority of its food and liquor from partners in the same states as its bars to give guests a taste of local flavor and home state pride, a decision that continues to receive widespread acclaim from consumers. Surveys repeatedly cite the wide selection of different, high-quality local beers as the number one feature that keeps drawing regulars and newcomers alike through the doors. 

In December 2018, CCAC announced its interest in opening a new bar somewhere in the United States. The new establishment's working name is The Meta Scientist. Its design concept is a casual hangout targeted at college students (of legal drinking age) and young professionals; the millennial generation, known for intentionally seeking novel experiences like new beers, constitutes a large segment of CCAC's existing clientele. All current brewery partners, along with a number of new potential partners located across the country, submitted the names of beers they would be interested in providing on opening day.

```{r logo2, out.width="150px", fig.align="center", echo=F}
knitr::include_graphics("Images/SMBrew.png")
```

To assist with its decision in choosing a state to host The Meta Scientist, CCAC has enlisted the aid of SMBrew Consulting (the authors of this document), a firm specializing in the hospitality industry. The client has provided us with two data sets:

* Breweries.csv: A table of 558 US breweries that have indicated interest in providing beer for The Meta Scientist.
* Beers.csv: A table of the 2,410 US craft beers those breweries make.

Additionally, CCAC has outlined several questions of interest about the data in its initial consultation document. For ease of use to our client, those questions are explicitly numbered and answered below.

# Data Input & Cleansing

First, the Beers.csv and Breweries.csv files are loaded into our analysis language and environment of choice, R and RStudio, as data frames. Aside from some instances of missing attributes, the data already looks tidy. Certain variables in each data frame are renamed in preparation for merging at a future step.

``` {r loading_and_cleaning}

# Initialize by loading data sets.
beers_raw <- read.csv("./Analysis/Beers.csv", 
                      header=TRUE, 
                      sep=",", 
                      na.strings=c("","NA"))
breweries_raw <- read.csv("./Analysis/Breweries.csv", 
                          header=TRUE, 
                          sep=",", 
                          na.strings=c("","NA"))

# Create working copies. Remove white space from State column.
beers_clean <- data.frame(beers_raw)
breweries_clean <- data.frame(breweries_raw)
breweries_clean$State <- as.factor(trimws(breweries_clean$State))

# Change column name of brewery ID to match for merging. Differentiate "Name" columns.
names(beers_clean)[names(beers_clean) == "Brewery_id"] <- "Brewery_ID"
names(beers_clean)[names(beers_clean) == "Name"] <- "Beer_Name"
names(breweries_clean)[names(breweries_clean) == "Brew_ID"] <- "Brewery_ID"
names(breweries_clean)[names(breweries_clean) == "Name"] <- "Brewery_Name"

# Change data types of Names to character. Style, City, and State remain factors.
beers_clean$Beer_Name <- as.character(beers_clean$Beer_Name)
breweries_clean$Brewery_Name <- as.character(breweries_clean$Brewery_Name)

```

# Questions of Interest:
## 1. How many breweries are present in each state? 

The number of breweries present in each state can be ascertained directly from the data frame of Breweries.csv. (For simplicity, Washington D.C. is referred to as a state, bringing the total number of states to 51.) Each occurrence of the state's abbreviation under the State column is interpreted as the corresponding brewery being located in the state. Therefore, we can count how many times the abbreviation appears to obtain the number of breweries in that state.

``` {r number_of_breweries_1}

# Count instances of state using count() from plyr.
breweries_count_state <- count(breweries_clean, "State")
names(breweries_count_state)[names(breweries_count_state) == "freq"] <- c("Num_Breweries")

# Choropleth map using usmap library, which returns ggplot objects. First clean state column to meet plot_usmap() argument requirements.
breweries_count_state$State <- as.character(breweries_count_state$State)
names(breweries_count_state)[names(breweries_count_state) == "State"] <- c("state")

# Then, create choropleth map.
bcs_choro <- plot_usmap(data = breweries_count_state, 
                        values = "Num_Breweries", 
                        lines = "brown") +
  ggtitle("Breweries Per State") +
  scale_fill_continuous(name = "Number of Breweries",
                        low = "white", 
                        high = "orange") +
  theme(legend.position="bottom",
        plot.title = element_text(hjust = 0.5))
bcs_choro

```

The above choropleth map provides a visual look at the number of breweries present in each state. Darker color indicates more breweries. Note that the flat number of breweries is used for the entire state; it is not adjusted by density or in terms of landmass, population, or location within the state.

```{r number_of_breweries_2, echo=F, results="hide"}

# Bar graph for all 50 states plus DC. Table output and choropleth map favored. An early placeholder visualization hidden in the final html document. Code saved to reuse for other bar graphs.
bcs_bars <- breweries_count_state %>% ggplot(aes(x = reorder(state, Num_Breweries), y = Num_Breweries)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  ggtitle("Number of Breweries Per State") +
  xlab("State") +
  ylab("Number of Breweries") +
  theme(plot.title = element_text(hjust = 0.5),
        axis.ticks = element_blank())

```

``` {r number_of_breweries_3}

# Kable output for breweries in each state.
kable(breweries_count_state,
      col.names = c("State",
                    "Number of Breweries"),
      row.names = T,
      caption="Number of breweries in each state:",
      table.attr="style='width:30%;'") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))

```

HOLD: NOTE THAT THE TABLE CANNOT BE SORTED IF THE JQUERY/DATATABLE COMMANDS ARE INACTIVE. THOSE CONFLICT WITH THE TOC FOR SOME REASON. (REWRITE THE PORTION OF THE FOLLOWING ANSWER THAT REFERENCES IT.)

This table provides the exact numbers. Its default setting has it sorted in descending alphabetical order by state abbreviation, but it can also be sorted by the number of breweries. The table can be queried for any particular state, but the following details are notable:

* Colorado has the most breweries, 47. It is the only state in this data set containing more than 40 breweries.
* California (39), Michigan (32), Oregon (29), Texas (28), Pennsylvania (25), Massachusetts (23), Washington state (23), Indiana (22), and Wisconsin (20) round out the rest of the top ten.
* Each state has at least one brewery in the data set.
* North Dakota, South Dakota, Washington DC, and Wyoming are tied for the least breweries, with one apiece.

## 2. Merge beer data with breweries data. 

The breweries and beers in these data sets have a one-to-many relationship; each brewery can produce multiple beers, but each beer is only linked to a single brewery. Both data sets share brewery ID as a common variable, so it can be used to merge the breweries data set into the beers data set for further analysis.

```{r merge}

# Merge data sets using shared Brewery_ID column.
merged_beers_clean <- merge(beers_clean, breweries_clean, by = c("Brewery_ID", "Brewery_ID"), all = TRUE)

# Reorder columns: all beer-related variables, then all brewery-related variables.
merged_beers_clean <- merged_beers_clean[c("Beer_Name", "Beer_ID", "ABV", 
                               "IBU", "Style", "Ounces",
                               "Brewery_Name", "Brewery_ID", "City", "State")]

# Check merged file by printing first and last six observations.
kable(head(merged_beers_clean, 6), 
      caption="First 6 Rows of Merged Data",
      row.names = T) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
kable(tail(merged_beers_clean, 6), 
      caption="Last 6 Rows of Merged Data",
      row.names = T) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))

```

The first and last six observations of the merged data frame are printed to show that the merge was successful. Note that because the brewery ID was used as the merging column, the new data frame is sorted in ascending order by that variable. Brewery_ID = 1 appears for the first six rows, while Brewery_ID = 558 appears in the final row of the last six, 558 being the number of breweries in the original Breweries.csv file. Furthermore, the row numbers for the last six observations indicate that all 2,410 craft beers from the original Beers.csv file made it into this merged data frame.

## 3. Report number of NAs in each column.

The above table of the last six observations displays "NA," or not available, for the International Bitterness Unit (IBU) variable, indicating that those beers are missing IBU values. Knowing whether or not a variable is missing values is important because unless the NAs are explicitly ignored, some functions in R will return NA as an answer if NA occurs even once.

```{r num_nas}

# Report the number of NAs in each column.
num_nas <- colSums(is.na(merged_beers_clean))
kable(num_nas, 
      col.names = c("Number of NAs"),
      caption="Number of NAs Per Column",
      table.attr="style='width:30%;'") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))

```

Any instances of NA are counted and reported in this table, which shows that the Alcohol By Volume (ABV) and IBU columns contain NAs, with 62 and 1,005, respectively. Additionally, 5 blanks in the Style column are also considered NAs. None of the other columns have missing values.



## 4. Compute median alcohol content and international bitterness unit for each state. 
Plot a bar chart to compare.
The median is calculated by using the aggregate function to apply the median command function to each of the ABV values listed by State.   The NA values are ignored.    The same process is used to calculate the median IBU by state.
```{r medians_abv_1}

# Calculate the median ABV values for each state, ignoring NAs.
abv_state_median <- aggregate(merged_beers_clean$ABV, 
                              list(merged_beers_clean$State), 
                              median, 
                              na.rm=TRUE)
names(abv_state_median)<-c("State", "Median_ABV")

# Plot bar chart of median ABVs.
abv_state_median$pgroup<-as.numeric(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5)

ggplot(abv_state_median, aes(x=abv_state_median$State, y=abv_state_median$Median_ABV, fill=Median_ABV)) + geom_bar(stat="identity") +
#geom_text( aes( label = paste0( State ), y = abv_state_median@Median_ABV ),
      #           vjust = 1.4, size = 3, color = "white" )  
coord_flip() + ggtitle("ABV Median by State") + xlab("State") + ylab("ABV Median") +
 theme(plot.title = element_text(hjust = 0.5),
        axis.ticks = element_blank()) +
        facet_wrap(~ abv_state_median$pgroup)

```
The output is a new dataframe called abv_state_median that contains the median ABV value for each state. 
```{r medians_abv_2}

kable(abv_state_median, format="markdown", caption="Median ABV For Each State")

```

```{r medians_ibu_1}

# Calculate the median IBU values for each state, ignoring NAs.
ibu_state_median <- aggregate(merged_beers_clean$IBU, 
                              list(merged_beers_clean$State), 
                              median, 
                              na.rm=TRUE)
names(ibu_state_median)<-c("State", "Median_IBU")

# Plot bar chart of median IBUs.

ggplot(ibu_state_median, aes(x=ibu_state_median$State, y=ibu_state_median$Median_IBU, fill=Median_IBU)) + geom_bar(stat="identity") +
coord_flip() + ggtitle("IBU Median by State") + xlab("State") + ylab("IBU Median") +
 theme(plot.title = element_text(hjust = 0.5),
        axis.ticks = element_blank())   

```
The output is a new dataframe called ibu_state_median that contains the median IBU value for each state.
``` {r medians_ibu_2}

kable(ibu_state_median, format="markdown", caption="Median IBU For Each State")

```
 


South Dakota's single brewery did not provide IBU values for its seven beers. For this reason, South Dakota has no bar in the bar graph above and its median IBU is reported as NA.

## 5. Which state has the most alcoholic beer by ABV? Most bitter beer by IBU? 
(Consider bar chart again, with top [5/10] in each category. However, highlight the number 1.)
```{r maximums_state}
abv_max <- max(merged_beers_clean$ABV, na.rm=TRUE)
ibu_max <- max(merged_beers_clean$IBU, na.rm=TRUE)
abv_max
ibu_max

#Convert State from Factor to Character
merged_beers_clean$State <- as.character(merged_beers_clean$State)

#Determine the highest ABV in each State (return by State)
abv.agg <- aggregate(ABV ~ State, merged_beers_clean, max)

#Now Sort the states by ABV descending
sorted_abv_agg<-abv.agg %>% arrange(desc(ABV))
first_ten_abv<-head(sorted_abv_agg, 10)
kable( head(first_ten_abv, 10), format="markdown", caption="Top 10 State ABV Values")


#Determine the highest IBU in each State (return by State)
ibu.agg <- aggregate(IBU ~ State, merged_beers_clean, max)

#Now Sort the states by IBU descending
sorted_ibu_agg<-ibu.agg %>% arrange(desc(IBU))
kable( head(sorted_ibu_agg, 10), format="markdown", caption="Top 10 State IBU Values")


#Now let's graph ABV (top 10)
abv_beers <- first_ten_abv %>% ggplot(aes(x= reorder(State, desc(ABV)), y = ABV)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  ggtitle("States by ABV") +
  xlab("State") +
  ylab("ABV") +
  theme(plot.title = element_text(hjust = 0.5), axis.ticks = element_blank()) + 
  theme(axis.text.x = element_text(angle = -90))
abv_beers

```

Colorado has the most alcoholic beer by ABV, with 0.128. Oregon has the most bitter beer by IBU, with a value of 138.

## 6. Summary statistics.
The summary statistics for ABV provide the min, max, median, mean, 1st and 3rd quartiles for the ABV value.  The NA's are not part of the calculation

```{r abv-summary-stats}

# summary() shows five-number summary, mean, and NAs.
summary(merged_beers_clean$ABV)
summary(merged_beers_clean$IBU)

# Five-number summary can also be displayed in a boxplot.
ggplot(merged_beers_clean, aes(x="", y=ABV)) +
  geom_boxplot() +
  ggtitle("Placeholder ABU boxplot")
ggplot(merged_beers_clean, aes(x="", y=IBU)) +
  geom_boxplot() +
  ggtitle("Placeholder IBU boxplot")

```
It's hard to see how the ABV are distributed; so looking at the boxplot, you can see that it's

## 7. Is there a relationship between ABV and IBU? 

With these two quantifiable variables for each beer, it is natural to wonder whether a relationship exists between them. A scatter plot is a useful visualization for this purpose.

```{r abv_ibu_relationship, message=F}

# Draw scatter plot using ggplot2.
abv_ibu_scatter <- merged_beers_clean %>% ggplot(aes(x = ABV, y = IBU)) + 
  geom_point(na.rm = TRUE, alpha = 0.5, col="#F19800") +
  xlab("Alcohol By Volume (ABV)") +
  ylab("International Bitterness Units (IBU)") +
  ggtitle("Relationship Between Beer’s\nBitterness and Alcoholic Content") +
  theme(plot.title = element_text(hjust = 0.5),
       axis.ticks = element_blank()) +
# Include linear regression.
  geom_smooth(method = "lm", 
              se = TRUE, 
              level = 0.95,
              aes(color = "CC720C", fill = "#F28E1C"))
 
abv_ibu_scatter

```

Based on the above scatter plot, there appears to be a positive correlation between ABV and IBU in this data. Generally speaking, as alcohol by volume increases, the bitterness in International Bitterness Units also tends to increase. The red best-fit line rising to the right upward diagonal represents this relationship. Note that any beer with at least one of its ABV or IBU values missing is not plotted.

``` {r correlation, message=F}

# Use cor() from base stats to calculate Pearson correlation coefficient.
r <- cor(merged_beers_clean$ABV, merged_beers_clean$IBU, 
         use = "pairwise.complete.obs",
         method = "pearson")

# Square Pearson's r to obtain coefficient of determination.
R_2 <- r^2

# Display r and R_2.
r_df <- data.frame("Variable" = c("Pearson Correlation Coefficient (r)", 
                                  "Coefficient of Determination (R^2)"),
                   "Value" = c(r, R_2))
kable(r_df,
      row.names=F,
      caption="Quantified Correlation") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))

```

Pearson's r quantifies the relationship between two variables on a scale of 0 (no linear association) to 1 (perfectly linear association). With r = 0.67, ABV and IBU in this data set have a moderate linear association.

# Additional Analysis
  
<!-- ## Style Analysis -->

```{r style_analysis, echo=F, results="hide"}

# General counts of beer styles. Obtain top 20 by brewing frequency.
beers_count_style <- count(merged_beers_clean, "Style")
names(beers_count_style)[names(beers_count_style) == "freq"] <- c("Style_Count")
beers_count_style_sorted <- beers_count_style %>% arrange(desc(Style_Count))
beers_count_style_sorted_top20freq <- beers_count_style_sorted[1:20, ]

# Total number of beer styles is 100.
num_styles <- n_distinct(beers_count_style$Style)
cat("The original data contains ", num_styles, " unique beer styles.")
# num_styles_check <- n_distinct(beers_raw$Style)
# cat("The raw version of beers contains ", num_styles_check, " unique beer styles. Does this match the other statement?")

kable(beers_count_style_sorted_top20freq, format="markdown", caption="The Top 20 Beer Styles by Frequency")

# Bar graph visualization.
style_bars <- beers_count_style_sorted_top20freq %>% ggplot(aes(x = reorder(Style, Style_Count), y = Style_Count)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  ggtitle("Top 20 Styles by Frequency") +
  xlab("Style") +
  ylab("Beers Per Style") +
  theme(plot.title = element_text(hjust = 0.5),
        axis.ticks = element_blank()
        )
style_bars

```

<!-- ## Brewery Analysis -->

```{r brewery_analysis, echo=F, results="hide"}
# Count instances of Brewery_Name to figure out how many beers each brewery makes.
beers_in_brewery <- count(merged_beers_clean, "Brewery_Name")
names(beers_in_brewery)[names(beers_in_brewery) == "freq"] <- c("Beer_Count")
beers_in_brewery <- beers_in_brewery %>% arrange(desc(Beer_Count))
beers_in_brewery_top20freq <- beers_in_brewery[1:20, ]
kable(beers_in_brewery_top20freq, format="markdown", caption="The Top 20 Breweries by Number of Unique Beers Brewed")

# merge the raw beers with the beers in brewery count
# merged_beers_raw <- merge(beers_clean, breweries_clean, by = c("Brewery_ID", "Brewery_ID"), all = TRUE)
merged_beers_prime_1 <- merge(beers_in_brewery, merged_beers_clean[, 7-10], by = c("Brewery_Name"), all = FALSE)
merged_beers_prime_2 <- merged_beers_prime_1 %>% arrange(desc(Beer_Count))
kable(merged_beers_prime_2, format="markdown")

# #Create a dataframe with just the Name and FT percentagerawfreeThrows<- data.frame(myspurs[2:nrow(myspurs),c(1,10)])
```

## Further Per State Analysis

```{r per_state}

# Similarly to counting the number of breweries in each state, count the number of beers made in each state.
beers_count_state <- count(merged_beers_clean, "State")
names(beers_count_state)[names(beers_count_state) == "freq"] <- c("Num_Beers")

# Count the number of styles per state.
styles_count_state <- aggregate(Style ~ State, 
                               merged_beers_clean, 
                               function(x) length(unique(x)))
names(styles_count_state)[names(styles_count_state) == "Style"] <- c("Unique_Styles")

# Output the top ten lists for breweries, beers, and styles for a side-by-side comparison.
breweries_count_state <- breweries_count_state %>% arrange(desc(Num_Breweries))
beers_count_state <- beers_count_state %>% arrange(desc(Num_Beers))
styles_count_state <- styles_count_state %>% arrange(desc(Unique_Styles))
breweries_beers_styles_count_state <- data.frame(breweries_count_state, beers_count_state, styles_count_state)
kable(breweries_beers_styles_count_state, 
      row.names = T,
      col.names = c("State", "Number of Breweries", 
                    "State", "Number of Beers",
                    "State", "Number of Styles"),
      caption = "Beers and breweries, per state:",
      table.attr = "style='width:90%;'") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))

```

Although the number of unique beers and unique beer styles correlates with the number of breweries per state, the top ten states in these categories are not necessarily the same or in the same order, as shown by this table. For example, Illinois, ranked 12th for number of breweries, ranks 8th for number of beers, trading places with Washington state, ranked 8th for number of breweries and 12th for number of beers. New York, ranked 13th for breweries and 11th for number of beers, ranks 7th for unique styles.

This is a distinction worth considering because the numbers of available beers and styles, CCAC's main draw, can be directly quantified instead of looking at the breweries alone. Current breweries may offer additional beers of different styles in the future, or new breweries may establish themselves in certain states, but neither of these are guaranteed.

```{r minimums_state}

# Lowest ABV and IBU per state.
abv_min_state <- aggregate(ABV ~ State, merged_beers_clean, min)
ibu_min_state <- aggregate(IBU ~ State, merged_beers_clean, min)

abv_min_state <- abv_min_state %>% arrange(ABV)
kable(abv_min_state)

ibu_min_state <- ibu_min_state %>% arrange(IBU)
kable(ibu_min_state)

```

California and Indiana also appear in the top 10 lists for lowest ABV and IBU, California ranking first for both. Carrying beers without strong alcohol or bitterness can appeal to customers who are not looking to get drunk or dislike bitter tastes.

# Conclusion

"Summarize your findings from this exercise."

* For these beers, ABV and IBU correlate.
* 3 states have good beer and style selection. Their ABV/IBU medians fall near the national average, indicating that they have wide varieties of beers that can appeal to different types of consumers.

# Storyline
## Notes
* Concept
  + Dr Cheun is an established bar owner, looking to open a new bar(s) across the U.S.  We are an analysist firm helping Dr. Cheun open bars.  
  + She is looking for:
    + Open a new bar, that has easy access to most breweries for the type of beers to target certain customers
    + Types of beer (look at "The Top 20 Beer Styles by Frequency" chart below)
    + Bar location (Dr. Cheun is based out of Nevada, we think you should not open up a new bar here)
    + Range of beer (which beers to have on tap)
    + Need to map current locations of her existing bars (to reconfirm current selection of beers against consumer base)
      + We analyzed our beers from ABV and IBU content and matched up the best selection based on your store location.
      + Beer xzy would do good here vs, beer def will do better in your TX bar because they like to get drunk quick
    + Demographics of this state is mostly xyz, and found this beer is a good fit for this abc beer
* Company Name
  + SM-Brew (new name in the works)
* Call out that Dr Cheun is the client (gave use the data to be analyzed) and we are the vendor/sales/ folks that took data, cleaned, merged it, made sense of it
  + 2 data files provided, had to merge them. 
  + in IBU and ABV, there was x number of these when we merged them by beers across states, there was x number of NAs for number of beers.  
  + We cleaned some things
* Content that must be worked into storyline
  + #1 Breweries per state
  + #4 Median ABV and IBU per state
  + #5 State w/ max ABV beer and most bitter 
  + #6 Summary statistic for ABV
  + #7 Relationship between ABV and IBU
* Cast
  + Dr. Cheun investor 

## Intro (2 mins)
*  Dr Cheun is an established bar owner, looking to open a new vegan bar across the U.S. to cator to the lack of choices vegatarians have when it comes to entertainment and social nightlife.  We are an analysist firm helping Dr. Cheun to choose the best location based on brewery logistics/distribution, alcoholic content/bitterness (use the relationship between bitterness and alcoholic content), and lastly the style of beer 

*  Our goal is to help you determine the best location and best bang for your buck on opening the new location based on the type of beer currently sold in the area to maximize drunkeness
* 

### Point 1 (4 mins)
* best location based on brewery logistics/distribution
  + Current logistics of brewery locations vs best possible bar opening location (reduce beer distribution cost)
  + based on Dr Cheun's current beer locations, it makes sense (from brewery location) to open bar in these 4 possible states
  + Current breakdown of breweries across the state (need table/chart)
  
* There are tax incentives to go with breweries that are located in the following 5 states (or, tx, nv, idaho).

* The East coast cost is extremely high and are recommending that the bar remain in the central/west region

### Point 2 (4 mins)
* alcoholic content/bitterness 
  + (use the relationship between bitterness and alcoholic content graph)
  + Based on the comparison of ABV and ounces per beer.  
  + First we looked the ABV median per state (4.1)
  + Then we looked the IBU median per state (4.2) determined that 
  
* We found that people like a good mix between bitterness and alcholic content.  We also found that the higher the alcolohic content, the more the person would drink

* We recommend a higher content beer


### Point 3 (4 mins)
* style of beer
  + We researched the styles of beer across the united states (show the table of Top 20 beer styles by frequency)

## Conclusion (2 mins)
From the information provided, we conclude that you should open a vegan bar in Paris, TX with the following beers offered x, y, z, which you would purchase from breweries (x, y, and z) to reduce your liability of being tied to 1 brewery 
